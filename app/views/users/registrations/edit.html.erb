<%# ------------------------------------------------------------------------- %>
<%#  BookBox – COM214 Final Project (Spring 2025)                             %>
<%#  Author contributions:                                                    %>
<%#    Cam Nguyen      – Lending modal & loan banner                          %>
<%#    Liana Bourdon   – Task lists, navbar tweaks                            %>
<%#    Annabelle Duval – Book cards, genre filter                             %>
<%# ------------------------------------------------------------------------- %>

<!-- app/views/users/registrations/edit.html.erb -->

<h2>My Account</h2>

<%= form_for(resource, as: resource_name,
             url: registration_path(resource_name),
             html: { method: :put }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="mb-3">
    <%= f.label :first_name %><br>
    <%= f.text_field :first_name, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :last_name %><br>
    <%= f.text_field :last_name, class: "form-control" %>
  </div>

  <div class="mb-3">
    <label class="form-label">Username</label>
    <p class="form-control-plaintext"><%= resource.username %></p>
  </div>



  <div class="mb-3">
    <%= f.label :email %><br>
    <%= f.email_field :email, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :password %>
    <small>(leave blank if you don’t want to change it)</small><br>
    <%= f.password_field :password, autocomplete: "off", class: "form-control" %>
    <% if @minimum_password_length %>
      <em><%= @minimum_password_length %> characters minimum</em>
    <% end %>
  </div>

  <div class="mb-3">
    <%= f.label :password_confirmation %><br>
    <%= f.password_field :password_confirmation, autocomplete: "off", class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :current_password %>
    <small>(required to confirm changes)</small><br>
    <%= f.password_field :current_password, autocomplete: "off", class: "form-control" %>
  </div>

  <div class="actions">
    <%= f.submit "Update", class: "btn btn-primary" %>
  </div>
<% end %>

<% unless resource.super_admin? %>
  <hr>
  <h3>Cancel my account</h3>
  <p>
    If you want to delete all your data, click below:&nbsp;
    <%= button_to "Cancel my account",
                  registration_path(resource_name),
                  method: :delete,
                  data: { confirm: "Are you sure? This cannot be undone." },
                  class: "btn btn-danger" %>
  </p>
<% end %>

<%= link_to "Back to Home", root_path, class: "btn btn-secondary mt-1 mb-4" %>

